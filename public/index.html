<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>MP Estética</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
<style>
:root{
--primary:#d4af86;
--bg:#0f0f0f;
--card:#ffffff10;
--text:#fff;
}
*{box-sizing:border-box;margin:0;padding:0;font-family:Poppins,sans-serif}
body{background:linear-gradient(120deg,#0f0f0f,#1c1c1c);color:var(--text);min-height:100vh;display:flex;align-items:center;justify-content:center}
.container{width:95%;max-width:1100px}
.header{text-align:center;margin-bottom:40px}
.title{font-size:2.8rem;font-weight:600;letter-spacing:2px}
.subtitle{opacity:.7;margin-top:10px}
.card{background:var(--card);backdrop-filter:blur(18px);border-radius:28px;padding:30px;box-shadow:0 0 40px #00000050}
.grid{display:grid;gap:20px}
@media(min-width:768px){.grid{grid-template-columns:1fr 1fr}}
label{font-size:.85rem;opacity:.8}
input,select,button{width:100%;padding:14px;border-radius:14px;border:none;margin-top:6px;font-size:1rem}
input,select{background:#ffffff15;color:white}
button{background:var(--primary);color:#000;font-weight:600;cursor:pointer;transition:.25s}
button:hover{transform:scale(1.03)}
button:disabled{opacity:.4;cursor:not-allowed}
.admin-btn{margin-top:15px;background:#ffffff15;color:#fff}
.toast{position:fixed;bottom:30px;left:50%;transform:translateX(-50%) scale(.8);background:#000;color:#fff;padding:16px 26px;border-radius:30px;opacity:0;transition:.4s}
.toast.show{opacity:1;transform:translateX(-50%) scale(1)}
.modal{position:fixed;inset:0;background:#000a;display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:.3s}
.modal.active{opacity:1;pointer-events:auto}
.modal-box{background:#111;padding:30px;border-radius:20px;width:90%;max-width:400px}
.dashboard{display:none;margin-top:30px}
.stat{background:#ffffff10;padding:20px;border-radius:18px;text-align:center}
.stat h3{font-size:2rem}
.theme-picker{display:flex;gap:10px;margin-top:15px}
.theme{width:30px;height:30px;border-radius:50%;cursor:pointer}
</style>
</head>
<body>
<div class="container">

<div class="header">
<div class="title">MP Estética</div>
<div class="subtitle">Michelle Pendola</div>
</div>

<div class="card">
<div class="grid">
<div>
<label>Servicio</label>
<select id="service">
<option value="Corte">Corte</option>
<option value="Color">Color</option>
<option value="Facial">Facial</option>
<option value="Limpieza">Limpieza</option>
</select>
</div>

<div>
<label>Fecha</label>
<input type="date" id="date">
</div>

<div>
<label>Hora</label>
<select id="time"></select>
</div>

<div>
<label>Nombre</label>
<input id="name">
</div>

<div>
<label>Teléfono</label>
<input id="phone">
</div>

<div>
<label>Email</label>
<input id="email">
</div>
</div>

<button onclick="book()">Reservar turno</button>
<button class="admin-btn" onclick="openAdmin()">Panel admin</button>

<div class="dashboard" id="dashboard">
<h2 style="margin-bottom:20px">Panel negocio</h2>
<div class="grid">
<div class="stat"><h3 id="statTotal">0</h3>Total turnos</div>
<div class="stat"><h3 id="statToday">0</h3>Hoy</div>
</div>

<h3 style="margin-top:25px">Color marca</h3>
<div class="theme-picker">
<div class="theme" style="background:#d4af86" onclick="setTheme('#d4af86')"></div>
<div class="theme" style="background:#ff6b81" onclick="setTheme('#ff6b81')"></div>
<div class="theme" style="background:#6bc5ff" onclick="setTheme('#6bc5ff')"></div>
<div class="theme" style="background:#7dffb3" onclick="setTheme('#7dffb3')"></div>
</div>
</div>

</div>
</div>

<div class="toast" id="toast">Turno reservado</div>

<div class="modal" id="loginModal">
<div class="modal-box">
<h3>Acceso admin</h3>
<input id="pass" type="password" placeholder="Contraseña" style="margin-top:15px">
<button style="margin-top:15px" onclick="login()">Ingresar</button>
</div>
</div>

<script>
const API="https://proyecto-estetica-2.onrender.com";

const hours=["10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00"];
const timeSelect=document.getElementById("time");
hours.forEach(h=>{let o=document.createElement("option");o.value=h;o.textContent=h;timeSelect.appendChild(o)});

async function loadBusy(){
const d=document.getElementById("date").value;
if(!d)return;
const res=await fetch(API+"/api/appointments/busy/"+d);
const data=await res.json();
[...timeSelect.options].forEach(o=>{
o.disabled=data.busySlots.includes(o.value);
});
}

document.getElementById("date").addEventListener("change",loadBusy);

async function book(){
const body={
service:service.value,
date:date.value,
time:time.value,
name:name.value,
phone:phone.value,
email:email.value
};

const r=await fetch(API+"/api/appointments",{
method:"POST",
headers:{"Content-Type":"application/json"},
body:JSON.stringify(body)
});

if(r.ok)showToast();
}

function showToast(){
const t=document.getElementById("toast");
t.classList.add("show");
setTimeout(()=>t.classList.remove("show"),3000);
}

function openAdmin(){
document.getElementById("loginModal").classList.add("active");
}

function login(){
if(pass.value==="mp2026"){
document.getElementById("loginModal").classList.remove("active");
loadStats();
dashboard.style.display="block";
}else alert("Incorrecto");
}

async function loadStats(){
const r=await fetch(API+"/api/appointments");
const data=await r.json();
statTotal.textContent=data.length;

const today=new Date().toISOString().split("T")[0];
statToday.textContent=data.filter(a=>a.date===today).length;
}

function setTheme(color){
document.documentElement.style.setProperty("--primary",color);
}
</script>
</body>
</html>
